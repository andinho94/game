<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE BODY KEEPS THE SCORE</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
        }
        
        body {
            font-family: 'Press Start 2P', cursive;
            background: #000;
            color: #f0f;
            overflow-x: hidden;
        }
        
        .game-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .game-container {
            width: 100%;
            max-width: 900px;
            background: #222;
            border: 8px solid #f0f;
            box-shadow: 0 0 40px rgba(255, 0, 255, 0.5);
            position: relative;
        }
        
        .crt-effect {
            pointer-events: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15),
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
            z-index: 1000;
        }
        
        .screen {
            background: #000;
            padding: 20px;
            min-height: 600px;
        }
        
        .title {
            text-align: center;
            font-size: 16px;
            color: #f0f;
            text-shadow: 2px 2px #0ff;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            font-size: 8px;
            color: #0ff;
            margin-bottom: 20px;
        }
        
        .progress-header {
            background: #111;
            border: 4px solid #f0f;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .xp-bar-container {
            background: #333;
            border: 2px solid #f0f;
            height: 20px;
            margin-bottom: 10px;
            position: relative;
        }
        
        .xp-bar-fill {
            background: linear-gradient(90deg, #f0f 0%, #0ff 100%);
            height: 100%;
            transition: width 0.5s;
        }
        
        .xp-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8px;
            color: #fff;
            text-shadow: 1px 1px #000;
        }
        
        .stats-row {
            display: flex;
            justify-content: space-around;
            font-size: 8px;
        }
        
        .stat-item {
            color: #f0f;
        }
        
        .stat-value {
            color: #0ff;
        }
        
        .skill-tree {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .skill-node {
            background: #1a001a;
            border: 4px solid #333;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            min-height: 120px;
        }
        
        .skill-node.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .skill-node.unlocked {
            border-color: #f0f;
        }
        
        .skill-node.unlocked:hover {
            background: #330033;
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.5);
        }
        
        .skill-node.completed {
            border-color: #0ff;
            background: #001a1a;
        }
        
        .skill-icon {
            font-size: 32px;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .skill-title {
            font-size: 8px;
            color: #f0f;
            text-align: center;
            margin-bottom: 8px;
        }
        
        .skill-progress {
            font-size: 7px;
            color: #0ff;
            text-align: center;
        }
        
        .skill-lock {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            overflow-y: auto;
        }
        
        .modal.active {
            display: block;
        }
        
        .modal-content {
            background: #000;
            border: 8px solid #f0f;
            padding: 20px;
            max-width: 700px;
            margin: 20px auto;
        }
        
        .lesson-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .lesson-title {
            font-size: 14px;
            color: #f0f;
            margin-bottom: 10px;
        }
        
        .lesson-subtitle {
            font-size: 8px;
            color: #0ff;
        }
        
        .teaching-section {
            background: #1a001a;
            border: 2px solid #f0f;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .teaching-text {
            font-size: 9px;
            line-height: 1.8;
            color: #f0f;
            margin-bottom: 15px;
        }
        
        .key-concept {
            background: #000;
            border-left: 4px solid #0ff;
            padding: 10px;
            margin: 15px 0;
        }
        
        .concept-title {
            color: #0ff;
            font-size: 8px;
            margin-bottom: 8px;
        }
        
        .concept-text {
            color: #f0f;
            font-size: 8px;
            line-height: 1.6;
        }
        
        .question-section {
            background: #000;
            border: 4px solid #f0f;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .question-text {
            font-size: 10px;
            color: #0ff;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .answers {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .answer-btn {
            background: #330033;
            border: 4px solid #f0f;
            color: #f0f;
            padding: 15px;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }
        
        .answer-btn:hover:not(.disabled) {
            background: #4d004d;
            border-color: #0ff;
            transform: translateX(5px);
        }
        
        .answer-btn.correct {
            background: #003300;
            border-color: #0f0;
            animation: correctPulse 0.5s;
        }
        
        .answer-btn.incorrect {
            background: #330000;
            border-color: #f00;
            animation: shake 0.5s;
        }
        
        .answer-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .feedback {
            margin-top: 15px;
            padding: 15px;
            border: 2px solid #f0f;
            font-size: 8px;
            line-height: 1.6;
            display: none;
        }
        
        .feedback.correct {
            background: #001a00;
            border-color: #0f0;
            color: #0f0;
            display: block;
        }
        
        .feedback.incorrect {
            background: #1a0000;
            border-color: #f00;
            color: #f00;
            display: block;
        }
        
        .continue-btn {
            background: #330033;
            border: 4px solid #f0f;
            color: #f0f;
            padding: 12px 30px;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            cursor: pointer;
            margin-top: 20px;
            float: right;
        }
        
        .continue-btn:hover {
            background: #4d004d;
            border-color: #0ff;
            color: #0ff;
        }
        
        .back-btn {
            background: #330000;
            border: 4px solid #f00;
            color: #f00;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            cursor: pointer;
            float: left;
        }
        
        .back-btn:hover {
            background: #550000;
            color: #ff0;
        }
        
        .completion-screen {
            text-align: center;
            padding: 40px 20px;
        }
        
        .completion-icon {
            font-size: 64px;
            margin-bottom: 20px;
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        .completion-title {
            font-size: 16px;
            color: #f0f;
            margin-bottom: 20px;
        }
        
        .xp-earned {
            font-size: 12px;
            color: #0ff;
            margin-bottom: 30px;
        }

        .level-indicator {
            background: #000;
            border: 2px solid #0ff;
            padding: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .level-text {
            color: #0ff;
            font-size: 10px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .nav-btn {
            flex: 1;
            background: #330033;
            border: 4px solid #f0f;
            color: #f0f;
            padding: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            cursor: pointer;
        }

        .nav-btn:hover {
            background: #4d004d;
            border-color: #0ff;
            color: #0ff;
        }

        .home-btn {
            background: #001a1a;
            border-color: #0ff;
            color: #0ff;
        }

        .home-btn:hover {
            background: #003333;
            border-color: #f0f;
            color: #f0f;
        }

        /* Keyboard focus improvements */
        .skill-node:focus {
            outline: 3px solid #0ff;
            outline-offset: 3px;
        }

        .answer-btn:focus,
        .continue-btn:focus,
        .back-btn:focus,
        .nav-btn:focus {
            outline: 2px solid #0ff;
            outline-offset: 2px;
        }

        /* Skill prerequisites tooltip */
        .skill-prereq {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 6px;
            color: #666;
            text-align: center;
        }

        .skill-node.locked .skill-prereq {
            color: #f0f;
        }

        /* Running score display */
        .score-tracker {
            background: #1a001a;
            border: 2px solid #f0f;
            padding: 10px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 8px;
            color: #0ff;
        }

        .score-value {
            color: #ff0;
            font-size: 10px;
        }

        /* Next skill button */
        .next-skill-btn {
            background: #330033;
            border: 4px solid #f0f;
            color: #f0f;
            padding: 12px 30px;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            cursor: pointer;
            margin-top: 20px;
            animation: pulse 2s infinite;
        }

        .next-skill-btn:hover {
            background: #4d004d;
            border-color: #0ff;
            color: #0ff;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body>
    <div class="game-wrapper">
        <div class="game-container">
            <div class="crt-effect"></div>
            <div class="screen">
                <div class="title">üíú THE BODY KEEPS THE SCORE üíú</div>
                <div class="subtitle">BESSEL VAN DER KOLK ON TRAUMA & THE BODY</div>
                
                <div class="progress-header">
                    <div class="xp-bar-container">
                        <div class="xp-bar-fill" id="xp-bar"></div>
                        <div class="xp-text" id="xp-text">0 / 100 XP</div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-item">LEVEL: <span class="stat-value" id="level-display">1</span></div>
                        <div class="stat-item">MASTERY: <span class="stat-value" id="mastery-display">0%</span></div>
                        <div class="stat-item">STREAK: <span class="stat-value" id="streak-display">0üî•</span></div>
                    </div>
                </div>

                <div class="level-indicator">
                    <div class="level-text">CURRENT PATH: <span id="current-path">FOUNDATIONS</span></div>
                </div>

                <div class="button-group">
                    <button class="nav-btn home-btn" onclick="window.location.href='learning-library-hub.html'">üè† HOME</button>
                    <button class="nav-btn" onclick="saveProgress()">üíæ SAVE</button>
                    <button class="nav-btn" onclick="loadProgress()">üìÅ LOAD</button>
                    <button class="nav-btn" onclick="resetProgress()">üîÑ RESET</button>
                </div>
                
                <div style="text-align: center; font-size: 6px; color: #666; margin-bottom: 15px;">
                    ‚å®Ô∏è SHORTCUTS: ESC=close ‚Ä¢ H=home ‚Ä¢ S=save ‚Ä¢ TAB=navigate
                </div>
                
                <div class="skill-tree" id="skill-tree"></div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="modal">
        <div class="modal-content" id="modal-content"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
        let gameState = {
            level: 1,
            xp: 0,
            xpToNextLevel: 100,
            totalXp: 0,
            streak: 0,
            completedSkills: [],
            skillProgress: {},
            currentLesson: null,
            currentQuestion: 0,
            correctAnswers: 0
        };

        const skillTree = [
            // LEVEL 1: FOUNDATIONS
            {
                id: 'trauma-in-body',
                title: 'Trauma Lives in Body',
                icon: 'ü´Ä',
                level: 1,
                xp: 20,
                prereq: null,
                lessons: [
                    {
                        title: 'Beyond Talk Therapy',
                        teaching: `Van der Kolk's central thesis: TRAUMA IS NOT STORED PRIMARILY IN NARRATIVE MEMORY - it lives in the BODY. In sensations, physiological responses, automatic reactions.

Traditional talk therapy assumes: if you understand and verbalize trauma, you heal. But trauma operates at PRE-VERBAL, SUBCORTICAL level. Talking ABOUT trauma often doesn't access where it lives.

The body keeps the score = body remembers and holds trauma even when mind doesn't consciously recall. Symptoms: chronic pain, autoimmune issues, digestive problems, hypervigilance, startle response - these are body's way of "keeping score."`,
                        concepts: [
                            {
                                title: 'Implicit vs Explicit Memory',
                                text: 'EXPLICIT (narrative): "I remember being hit at age 5." IMPLICIT (body): Heart racing when someone raises their voice, flinching when touched, gut clenching in certain situations. Trauma often lives in implicit - body remembers even when mind doesn\'t.'
                            },
                            {
                                title: 'Why Words Aren\'t Enough',
                                text: 'Trauma overwhelms language centers. Broca\'s area (speech production) goes offline during trauma activation. Can\'t "talk yourself out" of body-based response. Need body-based interventions: movement, breath, sensation awareness, somatic experiencing.'
                            }
                        ],
                        questions: [
                            {
                                question: 'Client says "I\'ve talked about my childhood abuse for years in therapy but still have panic attacks." What does van der Kolk\'s framework suggest?',
                                answers: [
                                    { text: 'They need to talk about it more', correct: false, feedback: 'Van der Kolk argues MORE talking often doesn\'t help if trauma is held in body, not narrative. Talk therapy has limits for trauma.' },
                                    { text: 'Trauma is stored in body/nervous system, not just narrative memory - need somatic interventions that address physiological activation', correct: true, feedback: 'EXACTLY! Talking accesses explicit memory (narrative), but panic attacks are IMPLICIT body memory - automatic physiological response. Client\'s nervous system is stuck in survival mode. Need interventions that work with BODY: EMDR, somatic experiencing, yoga, neurofeedback, movement. These help nervous system update: "Danger is over, I\'m safe now." Cognitive understanding alone can\'t override subcortical activation.' },
                                    { text: 'They\'re not trying hard enough', correct: false, feedback: 'Blame/shame approach. Misses that trauma responses are physiological, not conscious choice. Can\'t willpower away autonomic nervous system activation.' },
                                    { text: 'Panic attacks are unrelated to trauma', correct: false, feedback: 'Van der Kolk shows clear link: trauma ‚Üí altered stress response ‚Üí symptoms like panic. Understanding this connection is crucial for treatment.' }
                                ]
                            },
                            {
                                question: 'What does "the body keeps the score" mean?',
                                answers: [
                                    { text: 'Your body tracks how much exercise you do', correct: false, feedback: 'Way too literal! This is about trauma, not fitness tracking.' },
                                    { text: 'Body stores trauma as physical sensations, symptoms, and automatic responses even when mind has "forgotten"', correct: true, feedback: 'YES! Examples: Veteran with IED trauma has chronic gut pain (body held terror). Abuse survivor flinches at touch (body remembers danger). Person with attachment trauma gets migraines when stressed (body\'s stress response shaped by early neglect). Body LITERALLY keeps score through: altered stress hormones, immune dysfunction, chronic pain, digestive issues, cardiovascular changes. These aren\'t "psychosomatic" (fake) - they\'re REAL physiological impacts of trauma.' },
                                    { text: 'Traumatic memories are always conscious', correct: false, feedback: 'Opposite! Van der Kolk emphasizes trauma often lives OUTSIDE conscious awareness - in body memory, not explicit recall.' },
                                    { text: 'Only physical injuries create body symptoms', correct: false, feedback: 'No! PSYCHOLOGICAL trauma creates PHYSICAL changes. Mind-body split is false - they\'re one system. Emotional trauma has somatic consequences.' }
                                ]
                            },
                            {
                                question: 'Why does van der Kolk argue traditional talk therapy often fails for trauma?',
                                answers: [
                                    { text: 'Because therapists aren\'t skilled enough', correct: false, feedback: 'Not about skill - about MODALITY limits. Even skilled talk therapist can\'t access subcortical trauma with words alone.' },
                                    { text: 'Trauma is stored in subcortical brain regions (amygdala, brainstem) that don\'t respond to language - need interventions that work with body/nervous system directly', correct: true, feedback: 'EXACTLY! Brain scan research shows: during trauma activation, prefrontal cortex (thinking, language) goes offline while amygdala (fear center) and brainstem (survival) light up. Talking engages cortex - doesn\'t reach where trauma lives. This is why: talking ABOUT scary memory doesn\'t reduce fear response. Need to work with: body (somatic therapy), rhythm (drumming, movement), bilateral stimulation (EMDR), imagery, or direct nervous system modulation (neurofeedback). These access subcortical where trauma lodges.' },
                                    { text: 'Talk therapy is completely useless', correct: false, feedback: 'Not what van der Kolk says! Talk therapy helps with: meaning-making, understanding patterns, building relationship. But it\'s INSUFFICIENT for trauma - needs to be combined with body-based work.' },
                                    { text: 'People with trauma can\'t talk', correct: false, feedback: 'They CAN talk, but talking doesn\'t necessarily access or resolve body-held trauma. It\'s about where trauma lives, not ability to speak.' }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                id: 'window-tolerance',
                title: 'Window of Tolerance',
                icon: 'ü™ü',
                level: 1,
                xp: 25,
                prereq: 'trauma-in-body',
                lessons: [
                    {
                        title: 'The Zone of Regulation',
                        teaching: `WINDOW OF TOLERANCE (Dan Siegel's concept, central to van der Kolk's work): zone of arousal where you can think clearly, process emotions, and respond flexibly. Inside window = regulated. Outside = dysregulated.

ABOVE window = HYPERAROUSAL: fight/flight activated - racing heart, panic, rage, hypervigilance, can't calm down, reactive.

BELOW window = HYPOAROUSAL: shutdown/freeze - numb, dissociated, depressed, foggy, disconnected, exhausted.

Trauma NARROWS your window. Non-traumatized person has wide window (can handle lots of stress). Traumatized person has narrow window (small trigger = big dysregulation).`,
                        concepts: [
                            {
                                title: 'Dysregulation Isn\'t Choice',
                                text: 'When outside window, prefrontal cortex (rational brain) is offline. You CAN\'T "calm down" or "think straight" through willpower alone. Need to: recognize dysregulation, use regulation tools (breathing, movement, grounding), gradually widen window through therapy.'
                            },
                            {
                                title: 'Goal Is Widening Window',
                                text: 'Healing = expanding window of tolerance. Can handle more stress while staying regulated. Tools: somatic work, mindfulness, titrated trauma processing, building felt safety. Over time, things that used to dysregulate you don\'t anymore.'
                            }
                        ],
                        questions: [
                            {
                                question: 'Client gets triggered during session - becomes agitated, can\'t focus, speech is pressured. They say "I can\'t calm down!" What\'s happening?',
                                answers: [
                                    { text: 'They\'re choosing to be difficult', correct: false, feedback: 'Blame/judgment. Misses that this is physiological state, not choice. They\'re ABOVE window of tolerance - nervous system has hijacked.' },
                                    { text: 'Hyperarousal - they\'re above their window of tolerance, sympathetic nervous system activated, need regulation tools not talk', correct: true, feedback: 'YES! Signs of hyperarousal: agitation, pressured speech, inability to focus, feeling "wired," can\'t settle. Prefrontal cortex is offline - can\'t access logic/reasoning. DON\'T: keep processing trauma (makes it worse), expect them to "calm down" with words. DO: help regulate - breathing (extend exhale), grounding (feet on floor, name 5 things you see), movement (walk, shake out), bilateral stimulation (butterfly hug), containment imagery. FIRST regulate, THEN process.' },
                                    { text: 'They need to try harder to relax', correct: false, feedback: 'Can\'t willpower out of dysregulation! This is autonomic nervous system - outside conscious control. Need physiological regulation strategies.' },
                                    { text: 'This is just anxiety, give them medication', correct: false, feedback: 'While medication might help long-term, immediate need is REGULATION. Learning to work with nervous system states is crucial skill. Don\'t just medicate - teach tools.' }
                                ]
                            },
                            {
                                question: 'Different client becomes very flat, spacey, says "I don\'t feel anything" when discussing trauma. What state are they in?',
                                answers: [
                                    { text: 'They\'re lying about not feeling anything', correct: false, feedback: 'They\'re likely telling truth of their experience - dissociation DOES create numbness. Don\'t assume deception.' },
                                    { text: 'Hypoarousal/dissociation - below window, dorsal vagal shutdown, need gentle activation not more trauma processing', correct: true, feedback: 'PERFECT! Signs of hypoarousal: numbness, fog, disconnection, flat affect, "I don\'t feel anything," fatigue. This is FREEZE response - dorsal vagal (shutdown) activation. DON\'T: push harder into trauma (drives them deeper into shutdown). DO: gentle activation - orient to present (look around room), body awareness (wiggle toes, stretch), small movements, resourcing (think of safe place/person). Bring them UP into window before processing. Dissociation is protection - respect it, work with it gently.' },
                                    { text: 'They\'re in perfect window of tolerance', correct: false, feedback: 'No - numbness/disconnection is BELOW window. In window = able to feel AND think. This is shutdown/freeze.' },
                                    { text: 'Keep pushing them to feel', correct: false, feedback: 'Dangerous! Dissociation protects from overwhelming affect. Forcing it can retraumatize. Need to titrate - small doses of feeling, with lots of regulation and safety.' }
                                ]
                            },
                            {
                                question: 'How does trauma narrow the window of tolerance?',
                                answers: [
                                    { text: 'It doesn\'t - window stays the same', correct: false, feedback: 'Trauma definitively narrows window. This is well-established in research and clinical experience.' },
                                    { text: 'Chronic trauma keeps nervous system on high alert - small stressors trigger big responses because system is already primed for danger', correct: true, feedback: 'YES! Trauma = nervous system learns world is dangerous. Baseline shifts: hypervigilant, easier to trigger, harder to calm. What non-traumatized person handles easily (conflict, stress, change) sends traumatized person outside window. Example: Non-traumatized person - partner is late ‚Üí mild concern. Traumatized person - partner is late ‚Üí panic, abandonment terror, rage. Same stimulus, different nervous system sensitivity. Healing widens window through: building safety, nervous system regulation, titrated trauma processing.' },
                                    { text: 'Only severe trauma narrows window', correct: false, feedback: 'Even "small" chronic trauma (emotional neglect, repeated criticism, instability) can narrow window. It\'s about cumulative impact and meaning to the person.' },
                                    { text: 'Window is genetic and can\'t change', correct: false, feedback: 'Window CAN expand with healing! Neuroplasticity - nervous system can learn safety. This is what trauma therapy does - gradually widens tolerance for activation without dysregulation.' }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                id: 'brain-changes',
                title: 'The Traumatized Brain',
                icon: 'üß†',
                level: 1,
                xp: 30,
                prereq: 'window-tolerance',
                lessons: [
                    {
                        title: 'Neuroscience of Trauma',
                        teaching: `Van der Kolk's research using brain imaging shows HOW trauma changes brain structure and function:

AMYGDALA (fear center): Becomes HYPERACTIVE - constantly scanning for danger, triggers false alarms. Like smoke detector that goes off when you cook toast.

PREFRONTAL CORTEX (executive function): UNDERACTIVE during trauma activation - can't think clearly, plan, or regulate emotions. The "thinking brain" goes offline.

HIPPOCAMPUS (memory/context): Often smaller in trauma survivors, struggles to properly time-stamp memories as "past." This is why flashbacks feel PRESENT, not remembered.

INSULA (body awareness): Can be overactive (overwhelming sensations) OR underactive (numbness, disconnection from body).`,
                        concepts: [
                            {
                                title: 'Stuck in Alarm Mode',
                                text: 'Traumatized brain stays in threat-detection mode. Amygdala screams danger when there isn\'t any. Body prepares for fight/flight when sitting safely in therapy office. This is NOT irrational - it\'s brain doing job it learned: SURVIVE. But alarm system is miscalibrated.'
                            },
                            {
                                title: 'Why Flashbacks Feel Real',
                                text: 'Hippocampus failure to contextualize memory as PAST means: when triggered, you don\'t just remember trauma - you RE-EXPERIENCE it. Brain/body respond as if it\'s happening NOW. This is why telling someone "it\'s in the past" doesn\'t help - their brain isn\'t experiencing it that way.'
                            }
                        ],
                        questions: [
                            {
                                question: 'Client has flashback during session - reliving assault, curled up, terrified. You say "You\'re safe, it\'s not happening now." They don\'t calm down. Why?',
                                answers: [
                                    { text: 'They\'re not listening to you', correct: false, feedback: 'They physically CAN\'T process your words. Language centers are offline during flashback. Subcortical brain is in charge.' },
                                    { text: 'Their hippocampus isn\'t contextualizing memory as past - brain/body experience it as happening NOW, logic/words can\'t override this', correct: true, feedback: 'EXACTLY! In flashback: hippocampus (context/time) offline, amygdala (fear) hijacked, prefrontal cortex (thinking) shut down. Your words hit cortex but cortex isn\'t driving. Need SUBCORTICAL interventions: orient to present through SENSES (feel chair under you, tap feet on ground, name objects you see), bilateral stimulation (alternating taps on knees), remind body it\'s safe through SENSATION not logic. Once nervous system downregulates, THEN cognitive ("it was past") can help.' },
                                    { text: 'Flashbacks aren\'t real experiences', correct: false, feedback: 'They\'re VERY real to nervous system! Brain/body respond as if trauma is occurring. Physiologically indistinguishable from actual threat in moment.' },
                                    { text: 'Just wait for flashback to pass on its own', correct: false, feedback: 'Can help them regulate sooner with right tools! Don\'t just watch them suffer. Active intervention (grounding, orientation) helps nervous system downregulate.' }
                                ]
                            },
                            {
                                question: 'What does hyperactive amygdala mean for daily life of trauma survivor?',
                                answers: [
                                    { text: 'They\'re constantly anxious for no reason', correct: false, feedback: 'There IS reason - miscalibrated threat detection system. Not "no reason" - brain learned world is dangerous and over-applies this learning.' },
                                    { text: 'Constant scanning for danger, overreacting to small stressors, difficulty relaxing, false alarms triggering fight/flight when actually safe', correct: true, feedback: 'YES! Hyperactive amygdala = smoke detector set too sensitive. Results: startle easily, can\'t relax (always vigilant), small things feel threatening (loud noise, unexpected touch, raised voice), exhausting hypervigilance, difficulty trusting safety even when present. NOT irrational - amygdala doing job it learned. Treatment: calm amygdala through: safety building, nervous system regulation, bottom-up approaches (EMDR, neurofeedback, somatic work).' },
                                    { text: 'Nothing - brain changes don\'t affect behavior', correct: false, feedback: 'Brain changes DIRECTLY create symptoms! This is biological basis of trauma responses. Understanding this reduces self-blame.' },
                                    { text: 'They\'re permanently broken', correct: false, feedback: 'NEUROPLASTICITY! Brain can change. With treatment, amygdala can calm, prefrontal cortex strengthen. Not permanent - changeable with right interventions.' }
                                ]
                            },
                            {
                                question: 'Why does van der Kolk emphasize brain imaging research?',
                                answers: [
                                    { text: 'To prove trauma survivors are brain damaged', correct: false, feedback: 'Not "damaged" - CHANGED. Important distinction. Changes are adaptive (helped survive) but create problems in safe contexts. And they\'re reversible!' },
                                    { text: 'To show trauma has measurable biological basis, reducing shame and validating that symptoms are real physiological responses, not weakness', correct: true, feedback: 'EXACTLY! Brain imaging PROVES: 1) Trauma changes brain structure/function (not "in your head" - it IS in your head, literally!), 2) Symptoms are biological, not character flaws, 3) Can see healing - brain changes with effective treatment (neuroplasticity visible on scans!). This: reduces shame ("I\'m not weak/crazy"), validates suffering, explains why willpower alone doesn\'t work, guides treatment (need to address BRAIN/BODY not just thoughts), offers hope (brain CAN heal).' },
                                    { text: 'Brain imaging is irrelevant to treatment', correct: false, feedback: 'Very relevant! Understanding WHICH brain areas are affected guides intervention. Example: underactive prefrontal cortex ‚Üí need regulation support before trauma processing.' },
                                    { text: 'To medicalize trauma and ignore psychological factors', correct: false, feedback: 'Van der Kolk integrates biological AND psychological AND social. Showing brain changes doesn\'t negate other factors - it enriches understanding.' }
                                ]
                            }
                        ]
                    }
                ]
            },

            // LEVEL 2: INTERMEDIATE
            {
                id: 'developmental-trauma',
                title: 'Developmental Trauma',
                icon: 'üë∂',
                level: 2,
                xp: 35,
                prereq: 'brain-changes',
                lessons: [
                    {
                        title: 'When Trauma Shapes Development',
                        teaching: `Van der Kolk distinguishes DEVELOPMENTAL TRAUMA (chronic childhood abuse/neglect) from single-incident adult trauma (car crash, assault). Developmental trauma is more pervasive because it occurs WHILE brain/identity/attachment are forming.

Child's brain develops through relationship with caregivers. When caregiver is source of BOTH safety AND danger (abusive parent), child's neurobiology develops in conflict: "I need you to survive but you hurt me."

This creates: disorganized attachment, difficulty regulating emotions, problems with trust, unstable sense of self, relationship difficulties that persist into adulthood.

Originally called "Developmental Trauma Disorder" - van der Kolk advocated for this diagnosis (not in DSM yet) because childhood trauma has different presentation than PTSD.`,
                        concepts: [
                            {
                                title: 'Complex PTSD',
                                text: 'Single trauma = PTSD (nightmares, flashbacks, avoidance, hypervigilance). Chronic childhood trauma = Complex PTSD: PLUS emotion dysregulation, negative self-concept, relationship problems, dissociation, somatic symptoms. Needs different treatment - more focus on: building self, learning regulation, attachment repair.'
                            },
                            {
                                title: 'Attachment & Neurobiology',
                                text: 'Secure attachment = brain wired for: safety, trust, regulation. Trauma attachment = brain wired for: danger, mistrust, dysregulation. This is DEVELOPMENTAL - happens before language, before conscious memory. Deeply embedded. Can heal but requires intensive, relationally-focused work.'
                            }
                        ],
                        questions: [
                            {
                                question: 'Adult client says "I don\'t remember specific trauma but I\'ve always felt anxious, can\'t trust people, hate myself." What does van der Kolk\'s framework suggest?',
                                answers: [
                                    { text: 'Without specific trauma memory, they don\'t have trauma', correct: false, feedback: 'Developmental trauma often doesn\'t have discrete memories - it was ONGOING ENVIRONMENT. Lack of memory doesn\'t mean lack of trauma impact.' },
                                    { text: 'Possible developmental trauma - chronic neglect/emotional abuse in childhood creates these patterns even without specific recall', correct: true, feedback: 'YES! Developmental trauma symptoms: chronic anxiety, trust issues, negative self-concept, relationship problems, emotion dysregulation. Often NO clear memories because: 1) Trauma was chronic environment not discrete event, 2) Occurred pre-verbally (before age when memories form), 3) Dissociation protected from encoding. Explore: "What was emotional atmosphere of childhood? When upset, who helped? Were your feelings welcomed?" Often discover: emotionally absent parents, unpredictability, lack of attunement. This IS trauma even without abuse "memory."' },
                                    { text: 'They\'re making it up', correct: false, feedback: 'Symptoms are REAL. Developmental trauma impacts are profound and measurable even without discrete memories of events.' },
                                    { text: 'Only physical/sexual abuse counts as trauma', correct: false, feedback: 'Emotional neglect, lack of attunement, chronic instability, witnessing violence - all create developmental trauma. Van der Kolk emphasizes: absence of what SHOULD be there (safety, attunement) is traumatic.' }
                                ]
                            },
                            {
                                question: 'How does developmental trauma differ from single-incident trauma (like car accident)?',
                                answers: [
                                    { text: 'No difference - all trauma is the same', correct: false, feedback: 'Van der Kolk makes crucial distinction! Different origins ‚Üí different presentations ‚Üí different treatment needs.' },
                                    { text: 'Developmental trauma occurs during critical brain development periods, affecting: attachment, identity formation, emotional regulation, sense of self - more pervasive impact', correct: true, feedback: 'EXACTLY! Single-incident: Adult has mostly formed brain/personality ‚Üí trauma creates symptoms (flashbacks, hypervigilance) but SELF is relatively intact. Can often resolve with trauma-focused therapy. Developmental: Trauma occurs WHILE forming ‚Üí affects FOUNDATION of: who you are, how you relate, how you regulate, whether you trust, your core beliefs about self/others/world. Needs: attachment repair, building self, regulation skills, longer therapy, more relational focus. Adult trauma = building gets damaged. Developmental trauma = foundation itself is compromised.' },
                                    { text: 'Developmental trauma is less serious', correct: false, feedback: 'Opposite! Often MORE serious because it\'s pervasive, affects development, harder to treat. Single-incident trauma can be very serious too, but developmental has unique challenges.' },
                                    { text: 'Only developmental trauma needs treatment', correct: false, feedback: 'Both need treatment! But treatment APPROACH differs based on type.' }
                                ]
                            },
                            {
                                question: 'Client had abusive alcoholic parent - source of both fear AND only available attachment. What conflict does this create?',
                                answers: [
                                    { text: 'No conflict - they should have just avoided the parent', correct: false, feedback: 'Child CAN\'T avoid primary caregiver - biological need for attachment overrides fear. This is the BIND that creates disorganized attachment.' },
                                    { text: 'Disorganized attachment - "I need you for survival but you hurt me" has no resolution, creates lifelong difficulty with intimacy and trust', correct: true, feedback: 'PERFECT! This is DISORGANIZED ATTACHMENT - most severe pattern. Child\'s biology says: "Must attach to survive." Same person triggers: terror. No solution. Can\'t approach (get hurt) OR avoid (lose attachment = death). Result: confused, contradictory strategies. Adult presentation: desperate for connection BUT terrified of it, push-pull in relationships, "I hate you don\'t leave me," difficulty trusting, testing relationships, sabotaging intimacy when it develops. Healing requires: therapist provides consistent, safe attachment (over YEARS often), client gradually learns "closeness doesn\'t mean danger."' },
                                    { text: 'This doesn\'t affect adult relationships', correct: false, feedback: 'PROFOUNDLY affects adult relationships! Attachment patterns formed with early caregivers become template for all relationships. Disorganized attachment creates chaos in intimacy.' },
                                    { text: 'They should just get over it', correct: false, feedback: 'This is neurodevelopmental wiring, not conscious choice. Can\'t "just get over" how brain organized around survival. Needs therapeutic rewiring through new attachment experience.' }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                id: 'emdr',
                title: 'EMDR',
                icon: 'üëÅÔ∏è',
                level: 2,
                xp: 40,
                prereq: 'developmental-trauma',
                lessons: [
                    {
                        title: 'Eye Movement Processing',
                        teaching: `Van der Kolk champions EMDR (Eye Movement Desensitization and Reprocessing) as effective trauma treatment because it works with BODY/BRAIN, not just narrative.

How it works: Client recalls trauma while doing bilateral stimulation (following therapist's finger moving side-to-side, or alternating taps). This seems to help brain PROCESS stuck traumatic memory.

Theory: Trauma memory gets "stuck" - not properly integrated. Bilateral stimulation activates both hemispheres, allows memory to move from limbic system (emotional, frozen) to cortex (processed, integrated). Like what happens naturally in REM sleep.

Result: Memory becomes LESS disturbing. Client can recall event without being flooded. "I remember it happened, but it doesn't control me anymore."`,
                        concepts: [
                            {
                                title: 'Not Just Exposure',
                                text: 'Some think EMDR is exposure therapy (repeatedly facing fear). Van der Kolk argues it\'s DIFFERENT - bilateral stimulation does something neurologically that pure exposure doesn\'t. Helps memory move from implicit (body) to explicit (narrative), from dysregulated to integrated.'
                            },
                            {
                                title: 'When It Works, When It Doesn\'t',
                                text: 'EMDR works well for: discrete traumatic events, PTSD. Less effective alone for: complex developmental trauma (needs more), dissociative disorders (can be destabilizing without preparation). Need: adequate regulation skills first, not actively in crisis, sufficient window of tolerance to process without flooding.'
                            }
                        ],
                        questions: [
                            {
                                question: 'Client asks: "How does moving my eyes back and forth help with trauma?" What\'s the explanation based on van der Kolk\'s understanding?',
                                answers: [
                                    { text: 'It\'s just distraction', correct: false, feedback: 'Not just distraction! Something neurologically specific happens with bilateral stimulation that aids processing.' },
                                    { text: 'Bilateral stimulation activates both brain hemispheres, helps move stuck traumatic memory from limbic (emotional/frozen) to cortex (integrated/processed)', correct: true, feedback: 'YES! Theory: Trauma memory is STUCK - emotionally charged, fragmented, not integrated into narrative. Bilateral stimulation (eyes, taps, alternating sounds) somehow facilitates: 1) Both hemispheres communicating, 2) Memory moving from amygdala (fear) to hippocampus/cortex (context, integration), 3) Shift from implicit (body reliving) to explicit (remembered event). Similar to what REM sleep does naturally but trauma memories resist. After EMDR: memory still there but CHARGE is gone - "I know it happened but I\'m not stuck in it."' },
                                    { text: 'Eyes are magic', correct: false, feedback: 'Not magic! Neurobiological mechanism. And can use taps or sounds instead of eyes - it\'s the BILATERAL aspect that matters.' },
                                    { text: 'EMDR erases traumatic memories', correct: false, feedback: 'Doesn\'t ERASE - PROCESSES. Memory remains but loses emotional intensity. You remember without reliving.' }
                                ]
                            },
                            {
                                question: 'Why does van der Kolk emphasize EMDR needs adequate preparation (can\'t just start with worst trauma)?',
                                answers: [
                                    { text: 'To make more money with more sessions', correct: false, feedback: 'Cynical and inaccurate! Preparation is ETHICAL necessity to prevent retraumatization.' },
                                    { text: 'Processing trauma without regulation skills/resources can overwhelm window of tolerance and retraumatize - need to build capacity first', correct: true, feedback: 'CRITICAL! EMDR activates trauma memory - if person doesn\'t have: 1) Regulation skills (breathing, grounding), 2) Resources (safe place imagery, coping), 3) Wide enough window of tolerance - they can flood, dissociate, get stuck in activation. This is RETRAUMATIZING. Preparation phase: assess window, teach regulation, establish resources, build therapeutic relationship. THEN target trauma. Especially crucial for: complex trauma, dissociation, recent trauma, fragile clients. Rushing into processing is dangerous and unethical.' },
                                    { text: 'EMDR doesn\'t actually work', correct: false, feedback: 'Extensive research shows EMDR is effective! But needs proper protocol including preparation phase.' },
                                    { text: 'Everyone can handle trauma processing immediately', correct: false, feedback: 'No! Window of tolerance varies hugely. Some people need MONTHS of stabilization before processing. Respecting this prevents harm.' }
                                ]
                            },
                            {
                                question: 'Client completes EMDR on car accident trauma. Says "I still remember the crash but it doesn\'t bother me anymore." What happened?',
                                answers: [
                                    { text: 'They\'re in denial', correct: false, feedback: 'This is SUCCESSFUL processing! Memory is integrated - present without emotional charge. Not denial.' },
                                    { text: 'Memory was successfully processed - moved from implicit (body reliving) to explicit (narrative past), emotional charge reduced', correct: true, feedback: 'EXACTLY! This is GOAL of EMDR: memory remains (explicit narrative) but CHARGE is gone (no longer triggering fight/flight). Before: thinking about crash ‚Üí panic, flashbacks, body activation. After: thinking about crash ‚Üí "yeah, that happened, it was scary" without physiological hijack. Memory properly contextualized as PAST, no longer experienced as present threat. This is integration - memory filed away appropriately rather than stuck in alarm system.' },
                                    { text: 'EMDR erased their memory', correct: false, feedback: 'Doesn\'t erase! They still REMEMBER - but memory is no longer traumatic. Important distinction.' },
                                    { text: 'They need more EMDR to feel something', correct: false, feedback: 'No! Lack of charge IS the goal. Trauma resolved when you can remember without being retraumatized by the memory itself.' }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                id: 'yoga-movement',
                title: 'Yoga & Movement',
                icon: 'üßò',
                level: 2,
                xp: 35,
                prereq: 'emdr',
                lessons: [
                    {
                        title: 'Befriending the Body',
                        teaching: `Van der Kolk's research on TRAUMA-SENSITIVE YOGA shows: movement/body awareness is powerful trauma treatment. Many trauma survivors are DISCONNECTED from bodies (because body = source of pain/fear).

Yoga provides: safe re-entry to body, learning body can be source of pleasure/strength, practicing agency ("I choose this movement"), regulation through breath, building interoception (awareness of internal sensations).

Different from regular yoga: emphasis on CHOICE (never forced), SAFETY (no hands-on adjustments without permission), INTEROCEPTION (notice what you feel inside), REGULATION (modulate arousal through breath/movement).

Other body-based approaches van der Kolk discusses: martial arts, dance, theater, drumming - anything that reconnects person to body in empowering, safe way.`,
                        concepts: [
                            {
                                title: 'Why Body Awareness Matters',
                                text: 'Trauma survivors often dissociate from body (too painful to feel). But: can\'t regulate what you can\'t feel. Healing requires: tuning IN to body (sensations, needs, signals), learning body is safe, building felt sense of inhabiting your body. Yoga teaches this without talking.'
                            },
                            {
                                title: 'Agency & Empowerment',
                                text: 'Trauma = loss of control. Yoga/movement = "I choose what my body does." This builds: sense of agency, confidence in body, experience of power rather than helplessness. Especially important for trauma survivors who had no choice (abuse, assault, captivity).'
                            }
                        ],
                        questions: [
                            {
                                question: 'Trauma survivor says "I hate my body, I don\'t want to do yoga or feel anything physical." Why this resistance?',
                                answers: [
                                    { text: 'They\'re just lazy', correct: false, feedback: 'Not laziness! Body holds trauma - approaching it can feel terrifying. This is protective avoidance.' },
                                    { text: 'Body became associated with pain/danger - disconnecting from it was survival. Reconnecting feels threatening even though it\'s healing', correct: true, feedback: 'EXACTLY! If body was: site of abuse, source of pain, betrayed you (froze when you wanted to fight), or out of control - you learned "body = danger, disconnect from it." Dissociation was ADAPTIVE. Now: reconnecting feels like approaching enemy territory. Yoga/movement asks you to FEEL body - this activates what you\'ve been avoiding. Approach: SLOWLY, with choice, in tiny doses. "Just notice breath. That\'s all." Build tolerance gradually. Eventually: body can become source of strength, pleasure, safety. But honor resistance - it protected you.' },
                                    { text: 'Force them to do yoga anyway', correct: false, feedback: 'NEVER force! That replicates trauma (loss of choice/control). Invite, don\'t demand. Respect their pace.' },
                                    { text: 'Body work is irrelevant for trauma', correct: false, feedback: 'Van der Kolk shows body work is CRUCIAL for many trauma survivors. But timing and approach matter - needs to feel safe.' }
                                ]
                            },
                            {
                                question: 'What makes "trauma-sensitive yoga" different from regular yoga class?',
                                answers: [
                                    { text: 'It\'s easier/gentler', correct: false, feedback: 'Not just about difficulty level - it\'s about APPROACH and awareness of trauma dynamics.' },
                                    { text: 'Emphasis on choice (not force), interoception (feel inside), safety (no surprise touch), language that offers invitation not command', correct: true, feedback: 'YES! Trauma-sensitive differences: 1) CHOICE - "You might try this" NOT "Do this pose." Student decides what feels right. 2) NO ASSISTS - teacher doesn\'t touch or adjust without clear consent. Surprise touch can trigger. 3) INTEROCEPTION - "Notice what you feel inside" rather than just form. 4) SAFETY - predictable, calm environment. 5) REGULATION focus - using breath/movement to modulate arousal. 6) NO mirrors (reduce self-consciousness). 7) Permission to modify/stop anytime. Regular yoga can be: directive, adjustment-heavy, competitive, pushing through - all triggering for trauma.' },
                                    { text: 'You have to disclose trauma to participate', correct: false, feedback: 'No disclosure required! Trauma-sensitive means approach ASSUMES trauma possible and creates safety for everyone, disclosed or not.' },
                                    { text: 'Only for people with PTSD diagnosis', correct: false, feedback: 'Trauma-sensitive approach benefits EVERYONE. Creates safer, more mindful practice regardless of trauma history.' }
                                ]
                            },
                            {
                                question: 'How does movement/yoga help trauma that\'s "stuck in the body"?',
                                answers: [
                                    { text: 'It doesn\'t - only talk therapy works', correct: false, feedback: 'Van der Kolk argues talk alone is often insufficient! Body-based work accesses what words can\'t reach.' },
                                    { text: 'Movement allows completion of thwarted survival responses, builds body awareness, teaches regulation, restores sense of agency over body', correct: true, feedback: 'PERFECT! How movement helps: 1) COMPLETING ACTION - trauma often involves interrupted fight/flight (froze when wanted to run). Movement lets body finish: push, shake, move. Discharges stuck energy. 2) INTEROCEPTION - learning to feel body again without overwhelm. Gradual exposure to sensation. 3) REGULATION - breath, grounding, noticing arousal and modulating it. 4) AGENCY - "I choose this movement" vs trauma\'s helplessness. 5) PLEASURE/STRENGTH - body as source of good feelings, power. 6) PRESENT MOMENT - moving requires presence, pulls from rumination. Not cognitive - EMBODIED learning.' },
                                    { text: 'It erases traumatic memories', correct: false, feedback: 'Doesn\'t erase memories - changes relationship to BODY. Body becomes less scary, more inhabitable.' },
                                    { text: 'Only helps physical injuries, not psychological trauma', correct: false, feedback: 'Psychological trauma HAS physical manifestation! Mind-body split is false. Movement addresses somatic dimension of psychological trauma.' }
                                ]
                            }
                        ]
                    }
                ]
            },

            // LEVEL 3: ADVANCED
            {
                id: 'neurofeedback',
                title: 'Neurofeedback',
                icon: 'üéÆ',
                level: 3,
                xp: 45,
                prereq: 'yoga-movement',
                lessons: [
                    {
                        title: 'Training the Brain',
                        teaching: `NEUROFEEDBACK: technique that shows real-time brain activity (via EEG) and teaches brain to self-regulate. Van der Kolk researched this extensively for trauma treatment.

How it works: Electrodes on scalp measure brain waves. Computer displays this as game/video. When brain produces desired wave pattern (e.g., more alpha for calm), game progresses. Brain learns: "This state = reward" and produces it more.

For trauma: helps calm overactive amygdala, strengthen prefrontal cortex, regulate arousal. Doesn't require talking about trauma - brain learns regulation directly through operant conditioning.

Van der Kolk found: significant PTSD symptom reduction, improved emotion regulation, better sleep. Particularly helpful for people who: can't tolerate talk therapy, are too dysregulated for processing, have tried everything else.`,
                        concepts: [
                            {
                                title: 'Brain Training Without Words',
                                text: 'Neurofeedback bypasses language entirely. You\'re literally training brain waves through feedback. For trauma held subcortically (below language), this direct approach can be powerful. Brain learns NEW patterns without needing to verbally process old trauma.'
                            },
                            {
                                title: 'Limitations',
                                text: 'Neurofeedback: helps with regulation, arousal, sleep. Doesn\'t address: meaning, relationships, behavioral patterns, cognitions. Best as PART of treatment, not sole intervention. Expensive, time-intensive (often 20-40 sessions). Not available everywhere. But for right person, can be game-changing.'
                            }
                        ],
                        questions: [
                            {
                                question: 'Client has tried multiple trauma therapies with limited success - still hypervigilant, poor sleep, easily triggered. How might neurofeedback help?',
                                answers: [
                                    { text: 'It won\'t - they\'re treatment resistant', correct: false, feedback: 'Not "resistant" - may need different APPROACH. Neurofeedback offers something other modalities don\'t.' },
                                    { text: 'Directly trains brain to regulate arousal without requiring trauma processing - helpful when dysregulation is so severe they can\'t engage other therapies', correct: true, feedback: 'YES! Some people are TOO dysregulated for trauma processing. Every approach requires some stability/regulation - they don\'t have it. Neurofeedback: 1) Works on REGULATION itself (not processing trauma), 2) Doesn\'t require talking, 3) Calms nervous system directly, 4) Can create stability NEEDED for other work. After neurofeedback: might then be able to engage EMDR, somatic work, etc. It\'s foundation-building - strengthening brain\'s capacity to regulate BEFORE addressing trauma content.' },
                                    { text: 'They should just try harder in regular therapy', correct: false, feedback: 'Not about effort! Their nervous system may need direct intervention to build regulation capacity. Neurofeedback provides this.' },
                                    { text: 'Neurofeedback is pseudoscience', correct: false, feedback: 'Van der Kolk\'s research shows real effects! Brain changes measurable on scans, symptom improvements significant. Evidence-based, not pseudoscience.' }
                                ]
                            },
                            {
                                question: 'What\'s the mechanism of change in neurofeedback?',
                                answers: [
                                    { text: 'Talking about trauma while watching screen', correct: false, feedback: 'No talking! That\'s the point - it\'s non-verbal brain training.' },
                                    { text: 'Operant conditioning - brain receives immediate feedback when producing desired wave patterns, learns to self-regulate through reinforcement', correct: true, feedback: 'EXACTLY! Like training any skill through feedback: 1) Brain produces wave pattern (e.g., calm alpha waves), 2) Computer detects this, gives reward (game advances, music plays), 3) Brain learns "this state = good" through reinforcement, 4) Over time, brain MORE EASILY produces desired state. No conscious effort - subcortical learning. Brain literally rewires through repeated practice. After training: can access calm states more readily, arousal less extreme/prolonged, better self-regulation. It\'s NEUROPLASTICITY through operant conditioning at neural level.' },
                                    { text: 'Placebo effect', correct: false, feedback: 'Research shows specific brain changes, not just placebo. Measurable effects on brain wave patterns, structure, and functioning.' },
                                    { text: 'Magic', correct: false, feedback: 'Not magic - neuroscience! Brain\'s capacity to learn new patterns through feedback is well-established principle.' }
                                ]
                            },
                            {
                                question: 'Why does van der Kolk emphasize neurofeedback as PART of treatment, not replacement for therapy?',
                                answers: [
                                    { text: 'Neurofeedback is useless', correct: false, feedback: 'He actively researches and recommends it! But within integrated approach.' },
                                    { text: 'Neurofeedback helps with regulation/arousal but doesn\'t address meaning, relationships, behaviors - need comprehensive treatment', correct: true, feedback: 'YES! Neurofeedback does: calms amygdala, improves arousal regulation, better sleep, reduced hypervigilance, strengthened prefrontal cortex. Doesn\'t do: process trauma memories, address relationship patterns, change cognitions, build meaning, repair attachment, teach skills. Person might be: calmer but still isolated, regulated but still self-hating, sleeping better but still stuck in destructive relationships. WHOLE PERSON needs: neurofeedback for biology + therapy for psychology + relationships for attachment + possibly medication + community support. Van der Kolk: comprehensive, integrated approach drawing from multiple modalities based on person\'s needs.' },
                                    { text: 'Insurance won\'t cover it so shouldn\'t mention it', correct: false, feedback: 'Cost/access are real barriers, but van der Kolk still discusses it because it CAN help. Advocates for better access while acknowledging limitations.' },
                                    { text: 'Only neurofeedback works, everything else is worthless', correct: false, feedback: 'Opposite! He\'s eclectic - believes in multiple effective approaches. Neurofeedback is ONE tool, not THE answer.' }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                id: 'theater-community',
                title: 'Theater & Community',
                icon: 'üé≠',
                level: 3,
                xp: 40,
                prereq: 'neurofeedback',
                lessons: [
                    {
                        title: 'Collective Healing',
                        teaching: `Van der Kolk explores THEATER and community-based approaches as trauma healing. His work with Shakespeare performances for trauma survivors shows: embodying different characters, working in ensemble, expressing emotions through performance = powerful healing.

Why theater works:
- SAFE CONTAINER for big emotions (it's "character" feeling, not you)
- BODY-BASED (movement, voice, presence)
- SOCIAL (connection, collaboration, being witnessed)
- AGENCY (choosing how to embody role)
- RHYTHM and synchrony (builds regulation)

Community healing recognizes: trauma often collective (genocide, war, systemic oppression), healing needs collective too. Individual therapy has limits when trauma is social/political. Need community witnessing, collective meaning-making, cultural practices.`,
                        concepts: [
                            {
                                title: 'Being Seen & Witnessed',
                                text: 'Trauma often happened in isolation or shame. BEING WITNESSED by community in healing context is profound: "Others see my pain and don\'t turn away. I\'m not alone. My story matters." Theater, group therapy, community rituals provide this witnessing that individual therapy can\'t fully offer.'
                            },
                            {
                                title: 'Rhythm & Synchrony',
                                text: 'Moving together (dance, drumming, choir, theater), breathing together, synchronized activity = nervous system regulation. We\'re wired for attunement. Collective rhythm calms individual arousal. This is ancient healing wisdom - most cultures had/have communal practices for processing collective trauma.'
                            }
                        ],
                        questions: [
                            {
                                question: 'Combat veteran struggles in individual therapy but thrives in group theater program. Why might this be?',
                                answers: [
                                    { text: 'Individual therapy failed them', correct: false, feedback: 'Not failure - different modality meeting different need. Both can be valuable.' },
                                    { text: 'Theater provides: collective experience (vs isolation), embodied expression, safe container for emotion, sense of purpose/meaning through performance', correct: true, feedback: 'EXACTLY! Why theater helps: 1) COLLECTIVE - combat is shared experience, healing in group mirrors that. Not alone. 2) EMBODIED - warriors are physical, theater uses body not just words. 3) SAFE EXPRESSION - can access rage, grief, fear through CHARACTER. 4) STRUCTURE - rehearsal, performance gives purpose. 5) WITNESSED - audience sees pain, responds with recognition not pity. 6) IDENTITY - "I\'m not just broken veteran, I\'m ARTIST." Individual therapy: important for personal processing. Theater: addresses isolation, gives meaning, rebuilds connection. Need both.' },
                                    { text: 'They\'re avoiding real therapy', correct: false, feedback: 'Theater IS real therapeutic work! Different approach, not avoidance. Van der Kolk shows it has measurable benefits.' },
                                    { text: 'Only works for extroverts', correct: false, feedback: 'Theater can be adapted for different personalities. Some trauma survivors bloom in this context who struggle in talk therapy, regardless of introversion/extroversion.' }
                                ]
                            },
                            {
                                question: 'Why does van der Kolk emphasize "collective trauma needs collective healing"?',
                                answers: [
                                    { text: 'Individual therapy is useless', correct: false, feedback: 'Not useless! But insufficient ALONE for collective trauma. Need both individual AND collective approaches.' },
                                    { text: 'When trauma is social/political (genocide, slavery, war), healing requires community witnessing, shared meaning-making, cultural restoration - not just individual treatment', correct: true, feedback: 'PROFOUND! Examples: Holocaust survivors, enslaved peoples\' descendants, Indigenous communities post-genocide, refugees, war survivors. Trauma is: COLLECTIVE (happened to group), ONGOING (systemic oppression continues), CULTURAL (destroyed practices, identities, communities). Individual therapy helps individual but can\'t address: collective grief, cultural loss, ongoing systemic harm, need for community validation. Collective healing: truth commissions, reparations, cultural revitalization, community rituals, collective witnessing, political action. Individual + collective both needed. Can\'t heal collective trauma in isolation.' },
                                    { text: 'Group therapy is cheaper', correct: false, feedback: 'Cost isn\'t the point! It\'s about nature of trauma and what healing requires. Collective trauma has collective dimensions individual work can\'t reach.' },
                                    { text: 'Everyone should stop individual therapy', correct: false, feedback: 'No! Van der Kolk advocates integrating approaches. Individual work still valuable, needs to be part of larger collective healing for collective trauma.' }
                                ]
                            },
                            {
                                question: 'Client asks why you recommend trauma-focused yoga class in addition to individual therapy. What\'s the rationale?',
                                answers: [
                                    { text: 'To make them busier', correct: false, feedback: 'Not about busyness! About addressing different dimensions of healing.' },
                                    { text: 'Group somatic work provides: collective regulation (nervous systems co-regulate), reduced isolation, body-based healing, rhythm/synchrony - complements individual therapy', correct: true, feedback: 'YES! What group adds: 1) CO-REGULATION - others\' calm helps you calm. Collective breathing, moving together regulates better than alone. 2) NORMALIZATION - "Others are traumatized too, I\'m not uniquely broken." 3) BELONGING - trauma creates isolation, group restores connection. 4) WITNESSED HEALING - others see your struggle and growth. 5) SOMATIC LEARNING - body work best in groups for some people (safe, structured). Individual therapy: process personal narrative, work with relationship, deeper exploration. Group: collective healing, somatic focus, social connection. Together = comprehensive.' },
                                    { text: 'Individual therapy isn\'t working', correct: false, feedback: 'Not replacement - SUPPLEMENT. Different modalities address different aspects of healing. Both/and, not either/or.' },
                                    { text: 'You can\'t help them alone', correct: false, feedback: 'Not about your inadequacy! Trauma healing is complex - benefits from multiple approaches. Integrated treatment is best practice, not therapist failure.' }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                id: 'integration-future',
                title: 'Integration & Future',
                icon: 'üåü',
                level: 3,
                xp: 50,
                prereq: 'theater-community',
                lessons: [
                    {
                        title: 'Putting It All Together',
                        teaching: `Van der Kolk's ultimate message: TRAUMA REQUIRES COMPREHENSIVE, INTEGRATED TREATMENT addressing multiple levels:

BIOLOGICAL: Medication (when needed), neurofeedback, regulation of arousal
PSYCHOLOGICAL: Processing memories (EMDR, therapy), meaning-making, cognition
SOCIAL: Relationships, community, being witnessed
SOMATIC: Body-based work (yoga, movement, somatic experiencing)

No single approach works for everyone. Need to: assess whole person, draw from multiple modalities, individualize treatment, address CURRENT safety while healing PAST trauma.

Future of trauma treatment: moving beyond JUST talk therapy, integrating body-based approaches, addressing social/collective dimensions, using technology (neurofeedback, VR), understanding neuroscience while honoring wisdom traditions (yoga, martial arts, ceremony).`,
                        concepts: [
                            {
                                title: 'Comprehensive Assessment',
                                text: 'Don\'t just ask "what happened?" Ask: window of tolerance (how regulated?), social support (isolated?), body relationship (connected or dissociated?), developmental history (single incident or chronic?), current safety (still in danger?), resources (what helps?). This guides which interventions to prioritize.'
                            },
                            {
                                title: 'Sequencing Matters',
                                text: 'Can\'t process trauma if: actively unsafe, severely dysregulated, no coping skills, unstable life (homelessness, active addiction). First: safety, stabilization, regulation skills. Then: trauma processing. Then: integration, meaning-making, post-traumatic growth. Rushing to processing before stability is retraumatizing.'
                            }
                        ],
                        questions: [
                            {
                                question: 'New trauma client asks: "What therapy will you do with me?" Based on van der Kolk, how do you answer?',
                                answers: [
                                    { text: '"EMDR" (or any single modality)', correct: false, feedback: 'Too narrow! Van der Kolk advocates comprehensive assessment first, then choosing from multiple approaches based on person\'s needs.' },
                                    { text: '"Let\'s assess together: your window of tolerance, current safety, what helps you regulate, your goals - then we\'ll draw from multiple approaches (talk, body-based, possibly EMDR, etc) based on what you need"', correct: true, feedback: 'PERFECT! This is: 1) COLLABORATIVE (assess TOGETHER), 2) COMPREHENSIVE (multiple dimensions), 3) INDIVIDUALIZED (based on YOUR needs), 4) FLEXIBLE (multiple tools available), 5) EDUCATIONAL (explaining options). Then might decide: First - build regulation through yoga, breathing. Then - process trauma with EMDR. Alongside - individual therapy for meaning-making. Plus - group for connection. Integrated approach, not one-size-fits-all. Explain: "Trauma is complex, treatment needs to match that complexity. We\'ll use what works for YOU."' },
                                    { text: '"Whatever you want"', correct: false, feedback: 'Too passive! Client needs your expertise to guide options. Collaborative doesn\'t mean directionless.' },
                                    { text: '"Only talk therapy, nothing else works"', correct: false, feedback: 'Directly contradicts van der Kolk\'s research! Talk alone is often insufficient. Need integrated approach.' }
                                ]
                            },
                            {
                                question: 'What\'s van der Kolk\'s main critique of how mental health system typically treats trauma?',
                                answers: [
                                    { text: 'Too focused on medication', correct: false, feedback: 'He critiques over-reliance on meds, but main issue is broader - ignoring body/social dimensions.' },
                                    { text: 'Over-reliance on talk therapy alone, ignoring that trauma lives in body and needs somatic/community approaches; also pathologizing instead of understanding', correct: true, feedback: 'YES! Van der Kolk\'s critiques: 1) TALK-ONLY - standard treatment is CBT/talk therapy. Ignores that trauma is SOMATIC. 2) INDIVIDUAL-ONLY - ignores social/collective dimensions. 3) PATHOLOGIZING - labels (PTSD, borderline) without understanding trauma origins. 4) INADEQUATE DIAGNOSIS - PTSD doesn\'t capture complex/developmental trauma. 5) MEDICATION OVER-USE - pills instead of addressing roots. 6) IGNORING BODY - medical model treats symptoms not embodied experience. 7) INSURANCE BARRIERS - won\'t cover yoga, EMDR, neurofeedback despite evidence. His vision: comprehensive, trauma-informed care that addresses whole person - body, mind, relationships, community.' },
                                    { text: 'Therapists aren\'t smart enough', correct: false, feedback: 'Not about intelligence! About systemic issues in how field conceptualizes and treats trauma.' },
                                    { text: 'Everything is fine with current system', correct: false, feedback: 'His entire book is critique of inadequate, narrow approach to trauma treatment! Calls for major shifts.' }
                                ]
                            },
                            {
                                question: 'What gives van der Kolk hope for future of trauma treatment?',
                                answers: [
                                    { text: 'Nothing - he\'s pessimistic', correct: false, feedback: 'Actually quite hopeful! Sees promising developments despite systemic barriers.' },
                                    { text: 'Growing understanding of neuroscience, evidence for body-based approaches, integration of ancient wisdom with modern science, trauma becoming less stigmatized', correct: true, feedback: 'YES! Sources of hope: 1) NEUROSCIENCE - proving what trauma does to brain, validating body-based approaches, showing change is possible (neuroplasticity). 2) EVIDENCE BASE - research supporting EMDR, yoga, neurofeedback, etc. Not just anecdotal. 3) INTEGRATION - bringing together: Western psychology + Eastern practices (yoga, meditation) + Indigenous wisdom + technology. 4) AWARENESS - trauma more recognized, less stigmatized, more funding. 5) SURVIVORS SPEAKING - voices of those affected shaping treatment. 6) INNOVATION - new approaches emerging (VR exposure, apps, peer support). Still barriers (insurance, access, cost) but trajectory is toward more comprehensive, effective, compassionate trauma care.' },
                                    { text: 'Everyone will just take pills', correct: false, feedback: 'He critiques over-reliance on medication! Hopes for movement AWAY from pills-only toward comprehensive care.' },
                                    { text: 'Trauma will be eliminated', correct: false, feedback: 'Unrealistic. Trauma will always occur (accidents, violence, loss). Hope is better RESPONSE - effective treatment, prevention where possible, trauma-informed communities.' }
                                ]
                            }
                        ]
                    }
                ]
            }
        ];

        function initSkillTree() {
            const container = document.getElementById('skill-tree');
            container.innerHTML = '';
            
            skillTree.forEach(skill => {
                const isCompleted = gameState.completedSkills.includes(skill.id);
                const isUnlocked = !skill.prereq || gameState.completedSkills.includes(skill.prereq);
                const progress = gameState.skillProgress[skill.id] || 0;
                const totalLessons = skill.lessons.length;
                
                const node = document.createElement('div');
                node.className = `skill-node ${isCompleted ? 'completed' : ''} ${isUnlocked ? 'unlocked' : 'locked'}`;
                
                // Find prerequisite skill name
                let prereqName = '';
                if (!isUnlocked && skill.prereq) {
                    const prereqSkill = skillTree.find(s => s.id === skill.prereq);
                    prereqName = prereqSkill ? prereqSkill.title : '';
                }
                
                node.innerHTML = `
                    ${!isUnlocked ? '<div class="skill-lock">üîí</div>' : ''}
                    <div class="skill-icon">${skill.icon}</div>
                    <div class="skill-title">${skill.title}</div>
                    ${isCompleted ? '<div style="margin-top:8px; color:#0ff;">‚úì MASTERED</div>' : ''}
                    ${!isUnlocked && prereqName ? `<div class="skill-prereq">Complete: ${prereqName}</div>` : ''}
                `;
                
                // Make unlocked nodes keyboard accessible
                if (isUnlocked && !isCompleted) {
                    node.setAttribute('tabindex', '0');
                    node.setAttribute('role', 'button');
                    node.setAttribute('aria-label', `Start ${skill.title} skill`);
                    node.onclick = () => startSkill(skill);
                    node.onkeypress = (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            startSkill(skill);
                        }
                    };
                }
                
                container.appendChild(node);
            });
            
            updateHeader();
            updatePathDisplay();
        }
        
        function updatePathDisplay() {
            const level = gameState.level;
            let path = 'FOUNDATIONS';
            if (level >= 3) path = 'ADVANCED';
            else if (level >= 2) path = 'INTERMEDIATE';
            
            document.getElementById('current-path').textContent = path;
        }
        
        function updateHeader() {
            const xpPercent = (gameState.xp / gameState.xpToNextLevel) * 100;
            document.getElementById('xp-bar').style.width = xpPercent + '%';
            document.getElementById('xp-text').textContent = `${gameState.xp} / ${gameState.xpToNextLevel} XP`;
            document.getElementById('level-display').textContent = gameState.level;
            
            const totalSkills = skillTree.length;
            const completedCount = gameState.completedSkills.length;
            const masteryPercent = Math.round((completedCount / totalSkills) * 100);
            document.getElementById('mastery-display').textContent = masteryPercent + '%';
            document.getElementById('streak-display').textContent = gameState.streak + 'üî•';
        }
        
        function startSkill(skill) {
            gameState.currentLesson = skill;
            gameState.currentQuestion = 0;
            gameState.correctAnswers = 0;
            showLesson(skill.lessons[0]);
        }
        
        function showLesson(lesson) {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            
            const concepts = lesson.concepts.map(c => `
                <div class="key-concept">
                    <div class="concept-title">${c.title}</div>
                    <div class="concept-text">${c.text}</div>
                </div>
            `).join('');
            
            content.innerHTML = `
                <div class="lesson-header">
                    <div class="lesson-title">${lesson.title}</div>
                    <div class="lesson-subtitle">${gameState.currentLesson.title}</div>
                </div>
                
                <div class="teaching-section">
                    <div class="teaching-text">${lesson.teaching}</div>
                    ${concepts}
                </div>
                
                <button class="continue-btn" onclick="startQuestions()">START QUESTIONS ‚Üí</button>
                <button class="back-btn" onclick="closeModal()">‚úï BACK</button>
                <div style="clear:both;"></div>
            `;
            
            modal.classList.add('active');
        }
        
        function startQuestions() {
            const lesson = gameState.currentLesson.lessons[0];
            showQuestion(lesson.questions[gameState.currentQuestion]);
        }
        
        function showQuestion(question) {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            
            window.currentQuestion = question;
            
            const answerButtons = question.answers.map((ans, idx) => `
                <button class="answer-btn" onclick="checkAnswer(${idx})">${ans.text}</button>
            `).join('');
            
            const progress = `Question ${gameState.currentQuestion + 1} of ${gameState.currentLesson.lessons[0].questions.length}`;
            const totalQuestions = gameState.currentLesson.lessons[0].questions.length;
            const scoreDisplay = gameState.currentQuestion > 0 
                ? `<div class="score-tracker">SCORE: <span class="score-value">${gameState.correctAnswers}/${gameState.currentQuestion}</span> correct so far</div>`
                : '';
            
            content.innerHTML = `
                <div class="lesson-header">
                    <div class="lesson-title">${gameState.currentLesson.title}</div>
                    <div class="lesson-subtitle">${progress}</div>
                </div>
                
                ${scoreDisplay}
                
                <div class="question-section">
                    <div class="question-text">${question.question}</div>
                    <div class="answers" id="answers">
                        ${answerButtons}
                    </div>
                    <div class="feedback" id="feedback"></div>
                </div>
                
                <div id="continue-container"></div>
                <button class="back-btn" onclick="closeModal()">‚úï BACK</button>
                <div style="clear:both;"></div>
            `;
            
            modal.classList.add('active');
        }
        
        function checkAnswer(idx) {
            const question = window.currentQuestion;
            const answer = question.answers[idx];
            
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => btn.classList.add('disabled'));
            
            const clickedBtn = buttons[idx];
            const feedback = document.getElementById('feedback');
            
            if (answer.correct) {
                clickedBtn.classList.add('correct');
                feedback.className = 'feedback correct';
                feedback.textContent = '‚úì CORRECT! ' + answer.feedback;
                gameState.correctAnswers++;
            } else {
                clickedBtn.classList.add('incorrect');
                feedback.className = 'feedback incorrect';
                feedback.textContent = '‚úó ' + answer.feedback;
            }
            
            const continueContainer = document.getElementById('continue-container');
            continueContainer.innerHTML = '<button class="continue-btn" onclick="nextQuestion()">CONTINUE ‚Üí</button>';
        }
        
        function nextQuestion() {
            gameState.currentQuestion++;
            const lesson = gameState.currentLesson.lessons[0];
            
            if (gameState.currentQuestion < lesson.questions.length) {
                showQuestion(lesson.questions[gameState.currentQuestion]);
            } else {
                completeSkill();
            }
        }
        
        function completeSkill() {
            const skill = gameState.currentLesson;
            const xpEarned = skill.xp;
            const questionsTotal = skill.lessons[0].questions.length;
            const score = Math.round((gameState.correctAnswers / questionsTotal) * 100);
            
            gameState.xp += xpEarned;
            gameState.totalXp += xpEarned;
            
            while (gameState.xp >= gameState.xpToNextLevel) {
                gameState.xp -= gameState.xpToNextLevel;
                gameState.level++;
                gameState.xpToNextLevel = Math.floor(gameState.xpToNextLevel * 1.5);
            }
            
            if (!gameState.skillProgress[skill.id]) {
                gameState.skillProgress[skill.id] = 0;
            }
            gameState.skillProgress[skill.id]++;
            
            if (!gameState.completedSkills.includes(skill.id)) {
                gameState.completedSkills.push(skill.id);
                gameState.streak++;
            }
            
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            
            // Find next available skill
            const currentIndex = skillTree.findIndex(s => s.id === skill.id);
            const nextSkill = skillTree.slice(currentIndex + 1).find(s => {
                if (!s.prereq) return true;
                return gameState.completedSkills.includes(s.prereq);
            });
            
            const nextSkillButton = nextSkill && !gameState.completedSkills.includes(nextSkill.id)
                ? `<button class="next-skill-btn" onclick="startNextSkill('${nextSkill.id}')">‚Üí NEXT: ${nextSkill.title}</button>`
                : '';
            
            content.innerHTML = `
                <div class="completion-screen">
                    <div class="completion-icon">${skill.icon}</div>
                    <div class="completion-title">SKILL MASTERED!</div>
                    <div class="xp-earned">+${xpEarned} XP EARNED</div>
                    <div class="teaching-text">
                        Score: ${score}% (${gameState.correctAnswers}/${questionsTotal} correct)<br><br>
                        You've completed "${skill.title}"<br><br>
                        The body keeps the score - and so do you!
                    </div>
                    ${nextSkillButton}
                    <button class="continue-btn" onclick="closeModalAndRefresh()">BACK TO SKILL TREE ‚Üí</button>
                </div>
            `;
            
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
            
            saveProgress();
        }
        
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }
        
        function closeModalAndRefresh() {
            closeModal();
            initSkillTree();
        }
        
        function saveProgress() {
            localStorage.setItem('bodyKeepsScoreAcademy', JSON.stringify(gameState));
        }
        
        function loadProgress() {
            const saved = localStorage.getItem('bodyKeepsScoreAcademy');
            if (saved) {
                gameState = JSON.parse(saved);
                initSkillTree();
                alert('‚úì Progress loaded!');
            } else {
                alert('No saved progress found.');
            }
        }
        
        function resetProgress() {
            if (confirm('Reset all progress? This cannot be undone.')) {
                localStorage.removeItem('bodyKeepsScoreAcademy');
                location.reload();
            }
        }
        
        function startNextSkill(skillId) {
            const skill = skillTree.find(s => s.id === skillId);
            if (skill) {
                closeModal();
                setTimeout(() => startSkill(skill), 300);
            }
        }
        
        initSkillTree();
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('modal');
            const isModalOpen = modal.classList.contains('active');
            
            // ESC to close modal
            if (e.key === 'Escape' && isModalOpen) {
                closeModal();
            }
            
            // H to go home (when modal is closed)
            if (e.key === 'h' && !isModalOpen) {
                window.location.href = 'learning-library-hub.html';
            }
            
            // S to save progress (when modal is closed)
            if (e.key === 's' && !isModalOpen) {
                e.preventDefault();
                saveProgress();
                alert('üíæ Progress saved!');
            }
        });
        
        // Make answer buttons keyboard accessible
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('answer-btn')) {
                e.target.focus();
            }
        });
        
        console.log('%cüíú BODY KEEPS SCORE ACADEMY LOADED', 'color: #f0f; font-size: 16px; font-weight: bold;');
        console.log('%c‚å®Ô∏è  Keyboard Shortcuts:', 'color: #0ff; font-size: 12px;');
        console.log('  ‚Ä¢ ESC - Close modal');
        console.log('  ‚Ä¢ H - Return to home');
        console.log('  ‚Ä¢ S - Save progress');
        console.log('  ‚Ä¢ TAB - Navigate skills');
        console.log('  ‚Ä¢ ENTER - Start selected skill');
    </script>
</body>
</html>
